# Автоматизация тестирования интернет-магазина.
Проектная работа по автоматизации тестирования.

## О проекте.

Данный проект направлен на проведение автоматизированного тестирования 
сайта "Магнит Аптека" расположенного по адресу - https://apteka.magnit.ru/.

В рамках данного проекта реализованы UI и API тесты, которые возможно провести
в рамках боевого сайта. Для написания API тестов были использованы эндпойнты
находящиеся в публичном доступе и не требующие авторизации.

## Структура каталогов

* **api** - содержит файл с базовыми методами для работы с API (base_api.py) и 
файлы содержащие методы для отправки и обработки различных запросов к ендпойнтам.
Для каждого ендпойнта создается собственный файл.
* **config** - содержит различные файлы конфигурации использующиеся для
хранения данных подключения к различным зонам.
* **data** - содержит файлы с тестовыми данными.
* **fixtures** - содержит файлы с фикстурами для api и ui.
* **json_schema** - содержит файлы с json схемами использующися для проверки
ответов api.
* **tests** - содержит файлы с тестами.
* **ui** - содержит файл с инициализацией веб-драйвера и структуру PageObject.
* **utils** - содержит файлы хелперов и декораторов.

## Запуск тестов.

Для запуска тестов необходимо передать в параметрах запуска следующие данные:
* **browser_name** - наименование браузера в котором запускаются ui тесты.
На данный момент реализован запуск в следующих браузерах:
* *  chrome
* * firefox
* **mode** - режим запуска (локальный или удаленный):
* * local (локальный)
* * remote (удаленный)
* **stand** - стенд для запуска тестов. На данный момент предусмотрен запуск
только на продуктивной зоне (prod)
* **hub** - адрес удаленного хаба для запуска тестов (например selenoid или selenium-grid) 
* **hub_port** - порт удаленного хаба для запуска тестов.
* **headless** - режим запуска браузера (безголовый или с головой).

## Пример запуска тестов.

python -m pytest --mode='remote' --stand='prod' --browser_name='chrome' --hub='192.168.3.107' --hub_port='4444' -n 2

## Запуск через Jenkins

Для запуска тестов через Jenkins в корне проекта реализован Jenkinsfile.
Для того, что бы сборка заработала, необходимо в сборку передать следующие
переменные:
* ${BROWSER} - имя браузера.
* ${STAND} - площадка для запуска.
* ${EXECUTOR_HUB} - адрес селениум хаба.
* ${EXECUTOR_PORT} - порт селениум хаба.
* ${STREAM_NUM} - количество паралельных потоков.

Для прогона тестов в Jenkins используется Docker. Для этого в корне проекта
реализован Dockerfile.

## Формирование отчетов

В проекте реализовано формирование отчетов с использованием фреймворка Allure.
Файлы отчета складываются в каталог "allure-results" в корне проекта. 
(Каталог для формирования отчетов прописан в файле "pytest.ini")

Для формирования отчетов из командной строки использовать команду "allure serve ./allure-results"
